(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{17:function(e,t,n){},19:function(e,t){e.exports="data:image/png;base64,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"},20:function(e,t,n){e.exports=n.p+"static/media/mob_menu.91a796f1.png"},24:function(e,t,n){e.exports=n.p+"static/media/resOk.e38b395c.svg"},25:function(e,t,n){e.exports=n.p+"static/media/false.4072126c.svg"},28:function(e,t,n){e.exports=n(38)},38:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(18),c=n.n(r),i=n(7),s=n(26),l=n(1),u=n(19),m=n.n(u),p=n(20),d=n.n(p);var f=function(e){function t(){"/signin"===e.crossLink?e.setEnterLink():e.setRegLink()}var n=o.a.createElement(o.a.Fragment,null,e.isMenuOpen?o.a.createElement("button",{type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.closeMenu,id:"closeMenu",className:"header__close-menu"}):o.a.createElement("img",{src:d.a,onClick:e.openMenu,className:"header__mobile-menu",alt:"\u043c\u0435\u043d\u044e"}));return o.a.createElement("header",{className:"header"},o.a.createElement("img",{src:m.a,className:"header__logo",alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f"}),e.loggedIn?n:o.a.createElement(i.b,{to:e.crossLink,onClick:t,className:"header__text header__text_doubler"},e.linkText),o.a.createElement("div",{className:"header__info"},e.loggedIn?o.a.createElement("p",{className:"header__text"},e.email):o.a.createElement(i.b,{to:e.crossLink,onClick:t,className:"header__text"},e.linkText),e.loggedIn?o.a.createElement("button",{onClick:e.signOut,className:"header__button"},"\u0412\u044b\u0439\u0442\u0438"):""))},h=o.a.createContext();var _=function(e){var t=o.a.useContext(h);console.log(e.card);var n=e.card.owner===t._id?{display:"block"}:{display:"none"},a=e.card.likes.some((function(e){return e._id===t._id})),r="card__like ".concat(a?"card__like_type_active":"");return o.a.createElement("template",{id:"card",className:"card"},o.a.createElement("button",{className:"card__delete",style:n,onClick:function(){e.onCardDelete(e.card)},type:"reset","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),o.a.createElement("img",{className:"card__image",onClick:function(){e.onCardClick(e.card)},"data-name":"",src:e.card.link,alt:e.card.name}),o.a.createElement("div",{className:"card__bottom"},o.a.createElement("h2",{className:"card__title"},e.card.name),o.a.createElement("button",{className:r,onClick:function(){e.onCardLike(e.card)},type:"button","aria-label":"\u041c\u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"}),o.a.createElement("h3",{className:"card__counter"},e.card.likes.length)))};var g=function(e){var t=o.a.useContext(h);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"profile__info"},o.a.createElement("img",{className:"profile__photo",src:t.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("div",{className:"profile__photo profile__photo_change",onClick:e.onEditAvatar}),o.a.createElement("h1",{className:"profile__title"},t.name),o.a.createElement("button",{className:"profile__button profile__button_type_edit",type:"button",onClick:e.onEditProfile}),o.a.createElement("p",{className:"profile__subtitle"},t.about)),o.a.createElement("button",{className:"profile__button profile__button_type_add",type:"button",onClick:e.onAddPlacePopup})),o.a.createElement("div",{className:"cards"},e.cards.map((function(t){return o.a.createElement(_,{key:t._id,card:t,onCardCick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))};var E=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__text"},"\xa9 2020 \u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u0410\u043a\u0443\u043b\u0438\u0447"))};var k=function(e){return o.a.createElement("form",{className:"signform"},o.a.createElement("p",{className:"signform__text"},"\u0412\u043e\u0439\u0442\u0438"),o.a.createElement("input",{type:"text",className:"signform__input",onChange:function(t){return e.setEmail(t.target.value)},value:e.email,placeholder:"Email",id:"email",name:"email"}),o.a.createElement("input",{type:"password",className:"signform__input",onChange:function(t){return e.setPassword(t.target.value)},value:e.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"pass",name:"pass"}),o.a.createElement("button",{type:"submit",className:"signform__submit",onClick:function(t){t.preventDefault(),e.onLogin()}},"\u0412\u043e\u0439\u0442\u0438"),o.a.createElement(i.b,{to:"/signup",onClick:e.changeLink,className:"signform__link"},"\u0415\u0449\u0435 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"))};var b=function(e){return o.a.createElement("form",{className:"signform"},o.a.createElement("p",{className:"signform__text"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("input",{type:"text",className:"signform__input",onChange:function(t){return e.setEmail(t.target.value)},value:e.email,placeholder:"Email",id:"email",name:"email"}),o.a.createElement("input",{type:"password",className:"signform__input",onChange:function(t){return e.setPassword(t.target.value)},value:e.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password"}),o.a.createElement("button",{type:"submit",className:"signform__submit",onClick:function(t){t.preventDefault(),e.onRegister()}},"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement(i.b,{to:"/signin",onClick:e.changeLink,className:"signform__link"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"))},v="http://api.loki.students.nomoreparties.co",C={email:"",password:"",name:"\u0416\u0430\u043a-\u0418\u0432 \u041a\u0443\u0441\u0442\u043e",about:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u043a\u0435\u0430\u043d\u0430",avatar:"https://kaskad.tv/images/2020/foto_zhak_iv_kusto__-_interesnie_fakti_20190810_1078596433.jpg"};var O=function(e){return o.a.createElement("section",{className:"popup ".concat(e.isOpen&&"popup_opened"),id:e.name},o.a.createElement("form",{className:"popup__container",name:e.name,onSubmit:e.onSubmit,method:"POST",action:"#",id:"form2"},o.a.createElement("button",{className:"popup__close",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose,id:"closeAdds"}),o.a.createElement("h2",{className:"popup__title"},e.title),e.children))};var j=function(e){var t=o.a.useContext(h),n=o.a.useRef(),a=o.a.useState(""),r=Object(l.a)(a,2),c=r[0],i=r[1];return o.a.useEffect((function(){i(t.avatar)}),[t]),o.a.createElement(O,{name:"editAvatar",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onLoad(),e.onUpdateAvatar({avatar:n.current.value})},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onLoad:e.onLoad,children:o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"url",ref:n,value:c||"",onChange:function(e){i(e.target.value)},placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,className:"popup__text popup__text_type_activity popup__text_type_avatar",id:"link-input",name:"link"}),o.a.createElement("button",{type:"submit",className:"popup__button popup__button_type_save"},e.isLoading))})};var y=function(e){var t=o.a.useContext(h),n=o.a.useState(""),a=Object(l.a)(n,2),r=a[0],c=a[1],i=o.a.useState(""),s=Object(l.a)(i,2),u=s[0],m=s[1];return o.a.useEffect((function(){c(t.name),m(t.about)}),[t]),o.a.createElement(O,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onLoad(),e.onUpdateUser({name:r,about:u})},name:"editProfile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onLoad:e.onLoad,children:o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"text",value:r||"",onChange:function(e){c(e.target.value)},required:!0,className:"popup__text popup__text_type_name",id:"name-input",name:"name",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451 -]*",minLength:"2",maxLength:"40"}),o.a.createElement("input",{type:"text",value:u||"",onChange:function(e){m(e.target.value)},required:!0,className:"popup__text popup__text_type_activity",id:"activity-input",name:"link",minLength:"2",maxLength:"200"}),o.a.createElement("button",{type:"submit",className:"popup__button popup__button_type_save"},e.isLoading))})};var A=function(e){var t=o.a.useContext(h),n=o.a.useRef(),a=o.a.useState(""),r=Object(l.a)(a,2),c=r[0],i=r[1];return o.a.useEffect((function(){i(t.link)}),[t]),o.a.createElement(O,{name:"addPlace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:e.isOpen,onClose:e.onClose,onLoad:e.onLoad,onSubmit:function(t){t.preventDefault(),e.onLoad(),e.onUpdatePlace({name:n.current.value,link:c})},children:o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"text",ref:n,defaultValue:"",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,className:"popup__text popup__text_type_name",id:"place-input",name:"name",minLength:"1",maxLength:"30"}),o.a.createElement("input",{type:"url",value:c||"",onChange:function(e){i(e.target.value)},placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,className:"popup__text popup__text_type_activity",id:"link-input",name:"link"}),o.a.createElement("button",{type:"submit",className:"popup__button popup__button_type_save"},e.isLoading))})};var w=function(e){return o.a.createElement("div",{className:"popup ".concat(e.isOpen&&"popup_opened"),id:"popupCard"},o.a.createElement("figure",{className:"popup__image-container"},o.a.createElement("button",{className:"popup__close popup__close_image",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",id:"cardClose",onClick:e.onClose}),o.a.createElement("img",{src:e.card.link,className:"popup__image",alt:e.card.name}),o.a.createElement("figcaption",{className:"popup__image-title"},e.card.name)))};var N=function(e){return o.a.createElement(O,{name:"popupConfirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onSubmit()},children:o.a.createElement("button",{type:"submit",className:"popup__button popup__button_type_save"},"\u0414\u0430")})},L=n(22),x=n(23),S=new(function(){function e(t){Object(L.a)(this,e),this.url=t.baseUrl}return Object(x.a)(e,[{key:"getUserInfo",value:function(e){return console.log(e),fetch("".concat(this.url,"/users/me"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return console.log(e),e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}},{key:"updateInfo",value:function(e,t,n){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}},{key:"setUserAvatar",value:function(e,t){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status," ").concat(e.statusText)))}))}},{key:"getInitialCards",value:function(e){var t=e.token;return fetch("".concat(this.url,"/cards"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}},{key:"addNewCard",value:function(e,t,n){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}},{key:"like",value:function(e,t){var n=e.token;return fetch("".concat(this.url,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status," ").concat(e.statusText)))})).then((function(e){return e}))}},{key:"dislike",value:function(e,t){var n=e.token;return fetch("".concat(this.url,"/cards/").concat(t,"/likes/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status," ").concat(e.statusText)))})).then((function(e){return e}))}},{key:"deleteCard",value:function(e,t){var n=e.token;return fetch("".concat(this.url,"/cards/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}}]),e}())({baseUrl:"https://api.loki.students.nomoreparties.co"});var P=function(e){return o.a.createElement(O,{name:"infoTooltip",title:"",submitText:"",isOpen:e.isOpen,onClose:e.onClose,children:o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:e.image,className:"popup__result",alt:""}),o.a.createElement("h1",{className:"popup__caption"},e.text))})},T=n(27),M=n(2),z=function(e){var t=e.component,n=Object(T.a)(e,["component"]);return o.a.createElement(M.b,null,(function(){return n.loggedIn?o.a.createElement(t,n):o.a.createElement(M.a,{to:"./signup"})}))},U=n(24),D=n.n(U),B=n(25),I=n.n(B);var J=function(e){return o.a.createElement("div",{className:"mobile-menu ".concat(e.isOpen&&"mobile-menu_opened")},o.a.createElement("p",{className:"mobile-menu__text"},e.userData.email),o.a.createElement("button",{onClick:function(){e.closeMenu(),e.signOut()},type:"reset",className:"mobile-menu__button"},"\u0412\u044b\u0439\u0442\u0438"))};n(17);var R=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],r=o.a.useState(!1),c=Object(l.a)(r,2),i=c[0],u=c[1],m=o.a.useState(!1),p=Object(l.a)(m,2),d=p[0],_=p[1],O=o.a.useState(!1),L=Object(l.a)(O,2),x=L[0],T=L[1],U=o.a.useState(!1),B=Object(l.a)(U,2),R=B[0],G=B[1],H=o.a.useState(!1),K=Object(l.a)(H,2),Y=K[0],Q=K[1],q=o.a.useState({link:"",name:""}),X=Object(l.a)(q,2),V=X[0],Z=X[1],F=o.a.useState({email:"",_id:"",name:"",about:"",avatar:""}),W=Object(l.a)(F,2),$=W[0],ee=W[1],te=o.a.useState([]),ne=Object(l.a)(te,2),ae=ne[0],oe=ne[1],re=o.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),ce=Object(l.a)(re,2),ie=ce[0],se=ce[1],le=o.a.useState("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),ue=Object(l.a)(le,2),me=ue[0],pe=ue[1],de=o.a.useState({}),fe=Object(l.a)(de,2),he=fe[0],_e=fe[1],ge=o.a.useState(!1),Ee=Object(l.a)(ge,2),ke=Ee[0],be=Ee[1],ve=o.a.useState({}),Ce=Object(l.a)(ve,2),Oe=Ce[0],je=Ce[1],ye=o.a.useState({crossLink:"/signin",linkText:"\u0412\u0445\u043e\u0434"}),Ae=Object(l.a)(ye,2),we=Ae[0],Ne=Ae[1],Le=o.a.useState(!1),xe=Object(l.a)(Le,2),Se=xe[0],Pe=xe[1],Te=o.a.useState(""),Me=Object(l.a)(Te,2),ze=Me[0],Ue=Me[1],De=o.a.useState(""),Be=Object(l.a)(De,2),Ie=Be[0],Je=Be[1],Re=o.a.useState(""),Ge=Object(l.a)(Re,2),He=Ge[0],Ke=Ge[1],Ye=Object(M.g)();function Qe(e){(function(e){var t=e.token;return fetch("".concat(v,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))})(e).then((function(e){ee(e),be(!0),Ye.push("/")})).catch((function(){return qe()})).finally((function(){S.getInitialCards(e).then((function(e){oe(e)})).catch((function(e){console.log(e)}))}))}function qe(){localStorage.removeItem("token"),be(!1),Ye.push("/signin")}function Xe(){T(!0)}function Ve(){se("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435")}function Ze(){Ne({crossLink:"/signup",linkText:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}function Fe(){Ne({crossLink:"/signin",linkText:"\u0412\u043e\u0439\u0442\u0438"})}function We(){a(!1),u(!1),_(!1),Q(!1),Z({}),G(!1),T(!1),pe("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),se("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}function $e(e){"Escape"===e.key&&We()}function et(e){e.target.classList.contains("popup_opened")&&We()}function tt(){Pe(!1)}return o.a.useEffect((function(){var e=localStorage.getItem("token");e&&Qe(e)}),[]),o.a.useEffect((function(){window.addEventListener("keydown",$e),window.addEventListener("click",et)})),o.a.createElement(h.Provider,{value:$},o.a.createElement("div",{className:"root"},o.a.createElement(y,{isOpen:i,onClose:We,onUpdateUser:function(e){var t=He;S.updateInfo(t,e.name,e.about).then((function(e){ee(e),We()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))},onLoad:Ve,isLoading:ie}),o.a.createElement(j,{isOpen:n,onClose:We,onUpdateAvatar:function(e){var t=He;S.setUserAvatar(t,e.avatar).then((function(e){ee(e),We()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))},onLoad:Ve,isLoading:ie}),o.a.createElement(A,{isOpen:d,onClose:We,onUpdatePlace:function(e){var t=He;console.log(t),function(e,t,n){var a=e.token;return fetch("".concat(v,"/cards"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}(t,e.name,e.link).then((function(e){Z(e),oe([e].concat(Object(s.a)(ae))),We()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))},onLoad:function(){pe("\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435")},isLoading:me}),o.a.createElement(N,{isOpen:R,onClose:We,onSubmit:function(){var e=He;S.deleteCard(e,he._id).then((function(){var e=ae.filter((function(e){return e._id!==he._id}));oe(e),We()}))},name:"popupConfirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitText:"\u0414\u0430"}),o.a.createElement(w,{isOpen:Y,onClose:We,card:V}),o.a.createElement(P,{text:Oe.text,image:Oe.image,isOpen:x,onClose:We,onLoad:Ve,isLoading:ie}),o.a.createElement("div",{className:"page"},ke?o.a.createElement(J,{userData:$,isOpen:Se,signOut:qe,closeMenu:tt}):"",o.a.createElement(f,{loggedIn:ke,isMenuOpen:Se,email:$.email,openMenu:function(){Pe(!0)},closeMenu:tt,signOut:qe,setLoggedIn:be,crossLink:we.crossLink,linkText:we.linkText,setEnterLink:Ze,setRegLink:Fe}),o.a.createElement("main",{className:"content"},o.a.createElement(M.d,null,o.a.createElement(z,{exact:!0,path:"/",loggedIn:ke,component:g,onEditAvatar:function(){a(!0)},onEditProfile:function(){u(!0)},onAddPlacePopup:function(){_(!0)},cards:ae,onCardLike:function(e){var t=He;e.likes.some((function(e){return e._id===$._id}))?S.dislike(t,e._id).then((function(t){var n=ae.map((function(n){return n._id===e._id?t:n}));oe(n)})):S.like(t,e._id).then((function(t){var n=ae.map((function(n){return n._id===e._id?t:n}));oe(n)}))},onCardDelete:function(e){G(!0),_e(e)},onCardClick:function(e){Q(!0),Z(e)},currentUser:$}),o.a.createElement(M.b,{path:"/signup"},o.a.createElement(b,{onRegister:function(){(function(e,t){return C.email=e,C.password=t,fetch("".concat(v,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then((function(e){return e.ok?e.json():Promise.reject(400===e.status)?"".concat(e.status," - \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435"):"".concat(e.status," - \u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")}))})(ze,Ie).then((function(e){e?(Ye.push("/signin"),je({text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",image:D.a}),Xe()):(je({text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",image:I.a}),Xe())})).catch((function(e){return console.log(e)}))},email:ze,setEmail:Ue,password:Ie,setPassword:Je,changeLink:Ze})),o.a.createElement(M.b,{path:"/signin"},o.a.createElement(k,{onLogin:function(){(function(e){var t=e.email,n=e.password;return fetch("".concat(v,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){try{if(200===e.status)return e.json();if(400===e.status)return Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)));if(401===e.status)return Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}catch(t){return t}})).catch((function(e){return Promise.reject(e)}))})({email:ze,password:Ie}).then((function(e){e&&(localStorage.setItem("token",e),Ke(e),console.log(He),Qe(e))})).catch((function(e){return console.log(e)}))},changeLink:Fe,email:ze,password:Ie,setPassword:Je,setEmail:Ue,setLoggedIn:be})),o.a.createElement(M.b,null,ke?o.a.createElement(M.a,{to:"/"}):o.a.createElement(M.a,{to:"/signup"})))),o.a.createElement(E,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,null,o.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.9694d1c6.chunk.js.map